{"version":3,"sources":["../../../src/components/probe/probe_details.js"],"names":[],"mappings":"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","file":"probe_details.js","sourcesContent":["import _ from 'lodash';\n\nexport class ProbeDetailsCtrl {\n\n  /** @ngInject */\n  constructor($scope, $injector, $location,$timeout, backendSrv, contextSrv) {\n    var self = this;\n    this.contextSrv = contextSrv;\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n    this.$timeout = $timeout;\n    this.pageReady = false;\n    this.collectors = [];\n    this.collector = null;\n    this.collectorUpdates = {};\n    var promise = this.getCollectors();\n    promise.then(function() {\n      self.getCollector($location.search().probe);\n    });\n    $scope.$on(\"$destroy\", function() {\n      $timeout.cancel(self.poller);\n    });\n  }\n\n  getCollectors() {\n    var self = this;\n    return this.backendSrv.get('api/plugin-proxy/raintank-worldping-app/api/collectors').then(function(collectors) {\n      self.collectors = collectors;\n    });\n  }\n\n  save() {\n    this.backendSrv.post(\"api/plugin-proxy/raintank-worldping-app/api/collectors\", this.collector);\n  }\n\n  getCollector(id) {\n    var self = this;\n    _.forEach(this.collectors, function(collector) {\n      if (collector.id === parseInt(id)) {\n        self.collector = collector;\n        self.collectorUpdates = {\n          \"name\": collector.name,\n          \"public\": collector.public\n        };\n        if (!collector.online) {\n          self.checkIfOnline();\n        }\n      }\n    });\n  }\n\n  setEnabled(newState) {\n    var self = this;\n    this.collector.enabled = newState;\n    this.backendSrv.post('api/plugin-proxy/raintank-worldping-app/api/collectors', this.collector).then(function() {\n      self.collector.enabled_change = new Date();\n    });\n  }\n\n  update() {\n    this.collector.name = this.collectorUpdates.name;\n    this.collector.public = this.collectorUpdates.public;\n    this.save();\n  }\n\n  remove(collector) {\n    var self = this;\n    this.backendSrv.delete('api/plugin-proxy/raintank-worldping-app/api/collectors/' + collector.id).then(function() {\n      self.$location.path('plugins/raintank-worldping-app/page/probes');\n    });\n  }\n\n  gotoDashboard(collector) {\n    this.$location.path(\"/dashboard/db/worldping-probes\").search({\"var-probe\": collector.slug, \"var-endpoint\": \"All\"});\n  }\n\n  gotoEventDashboard(collector) {\n    this.$location.path(\"/dashboard/db/worldping-events\").search({\"var-probe\": collector.slug, \"var-endpoint\": \"All\"});\n  }\n\n  getEventsDashboardLink() {\n    if (!this.collector) {\n      return \"\";\n    }\n    var path = \"/dashboard-solo/db/worldping-events\";\n    var qstring = \"?panelId=1&fullscreen&from=now-1d&to=now&var-probe=\"+this.collector.slug;\n    return path + qstring;\n  }\n\n  checkIfOnline() {\n    var self = this;\n    this.verifyOnline = true;\n\n    this.backendSrv.get('api/plugin-proxy/raintank-worldping-app/api/collectors/'+this.collector.id).then(function(res) {\n      self.collector = res;\n      if (!res.online) {\n        self.poller = self.$timeout(function() {\n          self.checkIfOnline();\n        }, 1000);\n      }\n    });\n  }\n}\n\nProbeDetailsCtrl.templateUrl = 'public/plugins/raintank-worldping-app/components/probe/partials/probe_details.html';\n"]}