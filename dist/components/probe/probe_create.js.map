{"version":3,"sources":["../../../src/components/probe/probe_create.js"],"names":[],"mappings":"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","file":"probe_create.js","sourcesContent":["import angular from 'angular';\nimport _ from 'lodash';\n\nvar defaults = {\n  name: '',\n  enabled: true,\n};\n\nclass ProbeCreateCtrl {\n\n  /** @ngInject */\n  constructor($scope, $injector, $location, $q, backendSrv, alertSrv) {\n    var self = this;\n    this.$q = $q;\n    this.alertSrv = alertSrv;\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n    this.newProbe = false;\n    this.installMethod = {\n      deb: false,\n      rpm: false,\n      docker: false,\n      manual: false,\n    };\n    this.probe = angular.copy(defaults);\n\n    if (\"probe\" in $location.search()) {\n      self.getProbe($location.search().probe);\n    } else {\n      self.reset();\n    }\n  }\n\n  setInstallMethod(newMethod) {\n    var self = this;\n    _.forEach(this.installMethod, function(enabled, method) {\n      if (method === newMethod) {\n        self.installMethod[method] = true;\n      } else {\n        self.installMethod[method] = false;\n      }\n    });\n    console.log(this.installMethod);\n  }\n\n  getProbe(id) {\n    var self = this;\n    return this.backendSrv.get(\"api/plugin-proxy/raintank-worldping-app/api/v2/probes/\"+id).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to get probe.\", resp.meta.message, 'error', 10000);\n        return self.$q.reject(resp.meta.message);\n      }\n      self.probe = resp.body;\n    });\n  }\n\n  reset() {\n    this.probe = angular.copy(defaults);\n  }\n\n  save() {\n    var self = this;\n    return this.backendSrv.put(\"api/plugin-proxy/raintank-worldping-app/api/v2/probes\", this.probe).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to save probe.\", resp.meta.message, 'error', 10000);\n        return self.$q.reject(resp.meta.message);\n      }\n    });\n  }\n\n  add() {\n    var self = this;\n    return this.backendSrv.post(\"api/plugin-proxy/raintank-worldping-app/api/v2/probes\", this.probe).then((resp) => {\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to add probe.\", resp.meta.message, 'error', 10000);\n        return self.$q.reject(resp.meta.message);\n      }\n      self.newCollector = true;\n      self.probe = resp.body;\n    });\n  }\n\n  configInfo() {\n    this.showConfigInfo = true;\n  }\n\n  defaultDistro() {\n    this.showDistroConfig = false;\n  }\n\n  otherDistro() {\n    this.showDistroConfig = true;\n  }\n}\n\nProbeCreateCtrl.templateUrl = 'public/plugins/raintank-worldping-app/components/probe/partials/probe_create.html';\nexport {\n  ProbeCreateCtrl\n};\n\n"]}